---
title: 'Encrypt and host R Markdown'
author: Matt Dray
date: '2021-05-07'
slug: encrypted-rmd
categories:
  - code
  - tutorial
tags:
  - encryptedRmd
  - github-pages
  - r
  - rmarkdown
draft: yes
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="tldr" class="section level1">
<h1>tl;dr</h1>
<p>You can knit an R Markdown file to an encrypted HTML with {encryptedRmd} and put it online with GitHub Pages. Users must enter the decryption key to download and view the content.</p>
</div>
<div id="tinkr-tailr" class="section level1">
<h1>TinkR TailR</h1>
<p>I’m working on a personal project that outputs an HTML document rendered from <a href="https://rmarkdown.rstudio.com/">an R Markdown file</a>. I want to share it with a specific person.</p>
<p>I don’t want to send them the file as an email attachment every time I update it. It would be convenient to give them a URL that always points to the latest version.</p>
<p>So maybe a password protected file? Encryption might be good too.</p>
<p>(There’s no big secret here. I just happened to watch <a href="https://m.imdb.com/title/tt1340800/">Tinker Tailor Soldier Spy</a> over the weekend.)</p>
</div>
<div id="invest-in-encrypto" class="section level1">
<h1>Invest in encrypto</h1>
<p>I’m a simple fellow. I don’t want to download or handle any software outside of R packages; I don’t want to configure anything; I like ‘free’ as in ‘I don’t have to pay for it’; I want minimal friction for users who are trying to access the content.</p>
<p>There’s definitely many ways to achieve this, but I decided to try out <a href="https://github.com/dirkschumacher/encryptedRmd">Dirk Schumacher’s {encryptedRmd} R package</a>, which I starred on GitHub a while ago and then forgot about.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> I’ve used <a href="https://pages.github.com/">GitHub Pages</a> for hosting a bunch of stuff out of GitHub repos; might as well try hosting it there.</p>
<div id="example" class="section level2">
<h2>Example</h2>
<p>I made <a href="https://github.com/matt-dray/encrypt-rmd-test">a simple GitHub repo</a> containing a demo of this approach.</p>
<p>The encrypted HTML output is <a href="https://matt-dray.github.io/encrypt-rmd-test/encrypt-test.html.enc.html">available online</a>,</p>
<p>You’ll be asked for a key to decrypt it. For this demo, the key is: <code>9ebf5d40b061c59330b9fce16703e4c2fb2fbf90a773996e43e49d562ea17039</code> (try it).</p>
<p>How was this created? In short, you knit an R Markdown as usual, but replace the output type in the YAML header. Here’s the steps:</p>
<ol style="list-style-type: decimal">
<li>Install {encryptedRmd} from CRAN if you haven’t already, using <code>install.packages("encryptedRmd")</code></li>
<li>Write an R Markdown file (i.e. extension .Rmd) where the <code>output:</code> field in the YAML header is set to <code>encryptedRmd::encrypted_html_document</code></li>
<li>Knit the file to render (i) an unencrypted ‘normal’ version HTML, (ii) an encrypted HTML version, and (iii) a text file containing the decryption key, all of which are generated by default in the same folder that the Rmd is in</li>
<li>To serve, commit and push only the encrypted file to GitHub and then activate GitHub Pages for the repo (go to ‘Settings’ &gt; ‘Pages’)</li>
</ol>
<p>Of course, you should add the R Markdown file, the unencrypted HTML and the decryption key to your .gitignore file, otherwise the content will be available for people to see.</p>
<p>I’ve retained all the output files in the demo repo so you can see them all. You can find them <a href="https://github.com/matt-dray/encrypt-rmd-test/tree/main/docs">in the <code>docs/</code> folder</a>:</p>
<pre><code>docs/
├── encrypt-test.Rmd
├── encrypt-test.html
├── encrypt-test.enc.html
└── encrypt-test.enc.html.key</code></pre>
<p>I told GitHub Pages to serve this <code>docs/</code> folder from the <code>main</code> branch, so that the URL ends up as <a href="https://matt-dray.github.io/encrypt-rmd-test/encrypt-test.html.enc.html">https://matt-dray.github.io/encrypt-rmd-test/encrypt-test.html.enc.html</a>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
</div>
</div>
<div id="get-a-job-in-cyber" class="section level1">
<h1>‘Get a job in cyber’</h1>
<p>Surprise, I am not a cyber security expert. The outlined approach does what I need and does so painlessly. I have no intention to share actually-sensitive information via this method, so I have little to worry about.</p>
<p>As noted by Dirk in <a href="https://github.com/dirkschumacher/encryptedRmd/blob/master/README.md#password-protected-html-markdown-documents">the {encryptedRmd} README</a>: use at your own risk.</p>
<hr />
<details>
<summary>
Session info
</summary>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.0.4 (2021-02-15)
##  os       macOS Big Sur 10.16         
##  system   x86_64, darwin17.0          
##  ui       X11                         
##  language (EN)                        
##  collate  en_GB.UTF-8                 
##  ctype    en_GB.UTF-8                 
##  tz       Europe/London               
##  date     2021-05-06                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────
##  package     * version    date       lib source                            
##  assertthat    0.2.1      2019-03-21 [1] CRAN (R 4.0.0)                    
##  blogdown      1.2        2021-03-04 [1] CRAN (R 4.0.2)                    
##  bookdown      0.21       2020-10-13 [1] CRAN (R 4.0.2)                    
##  cli           2.3.1      2021-02-23 [1] CRAN (R 4.0.2)                    
##  digest        0.6.27     2020-10-24 [1] CRAN (R 4.0.2)                    
##  evaluate      0.14       2019-05-28 [1] CRAN (R 4.0.0)                    
##  glue          1.4.2      2020-08-27 [1] CRAN (R 4.0.2)                    
##  htmltools     0.5.1.9000 2021-03-11 [1] Github (rstudio/htmltools@ac43afe)
##  knitr         1.32       2021-04-14 [1] CRAN (R 4.0.2)                    
##  magrittr      2.0.1      2020-11-17 [1] CRAN (R 4.0.2)                    
##  rlang         0.4.10     2020-12-30 [1] CRAN (R 4.0.2)                    
##  rmarkdown     2.6        2020-12-14 [1] CRAN (R 4.0.2)                    
##  sessioninfo   1.1.1      2018-11-05 [1] CRAN (R 4.0.0)                    
##  stringi       1.5.3      2020-09-09 [1] CRAN (R 4.0.2)                    
##  stringr       1.4.0      2019-02-10 [1] CRAN (R 4.0.0)                    
##  withr         2.4.1      2021-01-26 [1] CRAN (R 4.0.2)                    
##  xfun          0.22       2021-03-11 [1] CRAN (R 4.0.2)                    
##  yaml          2.2.1      2020-02-01 [1] CRAN (R 4.0.0)                    
## 
## [1] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</code></pre>
</details>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>All too often I ‘discover’ a cool-sounding project on GitHub only to find I’ve already starred it. Partly I’m forgetful. Partly it’s because I’ve starred so many things. (I think this phenomenon should have a word. Possibly a compound German word. Or like ‘<a href="https://en.wikipedia.org/wiki/Brown_dwarf">brown dwarf</a>’, because it’s a celestial object that had potential to begin fusion but didn’t quite make it? Rubbish analogy.) The {encryptedRmd} case is especially amusing because apparently I gave a thumbs-up to <a href="https://github.com/dirkschumacher/encryptedRmd/issues/2">an issue in the repo</a> posted by <a href="https://twitter.com/nacnudus">my colleague Duncan</a>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>You could simplify this by renaming your encrypted output file to <code>index.html</code>, which means you can refer to it with a shortened URL in the form <code>user.github.io/repo-name/</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
