---
title: 'Can {drake} RAP?'
author: Matt Dray
date: '2019-06-10'
slug: drake-lays-an-egg
categories:
  - R
tags:
  - reproducibility
  - drake
  - eggs
  - rap
  - reproducible analytical pipelines
  - make
  - make file
draft: yes
---

# Take the RAP

[Reproducible Analytical Pipelines](https://ukgovdatascience.github.io/rap-website/) (RAP) is an approach to generating [the UK government's official statistics](https://www.gov.uk/search/research-and-statistics) that improves reproducibility, minimises errors and speeds up production.

RAP does away with the tangled webs of spreadsheets, copy-pasting errors and infernal `publication_FINAL-v2_md-comments_FINAL.docx` file naming.

Instead, RAP encourages a script-based workflow that's beefed up with stuff like version control, dependency management and automated testing.

# Bake a {drake} make cake

One step along the RAP journey could be to use a ['makefile'](https://en.wikipedia.org/wiki/Makefile). This is a plain-text recipe file that codifies the order of script execution and minimises the need to re-run the entire code base during development.

[{drake}](https://github.com/ropensci/drake) is a package by [Will Landau](https://wlandau.github.io/) that lets you create make files with a distinct R flavour.

In brief, you prepare a 'plan' file that calls functions to perform you analysis and create your output. It's a bit like a cake recipe.

Sometimes you need to re-run your code if you've made a change. {drake} only runs the parts that have changed plus anything downstream that depends on those parts.

This saves compute time and means you don't have to remember any dependencies yourself.

{drake} even visualises a dependency network diagram for you so you can understand these relationships and what has changed following any modifications of the code.

There's some helpful material out there for learning more about {drake}.

* [User Manual](https://ropenscilabs.github.io/drake-manual/)
* [Documentation](https://ropensci.github.io/drake/)
* [Cheat sheet](https://github.com/krlmlr/drake-sib-zurich/blob/master/cheat-sheet.pdf) by Kirill MÃ¼ller
* [Drake for workflow happiness](https://aedobbyn.github.io/nyc-fires/index.html#1) slides by [Amanda Dobbyn](https://dobb.ae/)

# {drake} it to make it

What might an example of {drake}

* [GitHub](https://github.com/matt-dray/drake-egg-rap)
* [Example HTML output](https://matt-dray.github.io/drake-egg-rap/)

## Eggsample

There is a [National Statistics](https://www.statisticsauthority.gov.uk/osr/list-of-national-statistics/) [publication that tracks egg production](https://www.gov.uk/government/statistics/egg-statistics).

## Folder structure

## A very cunning plan

[^natstats]: In the UK, National Statistics are a special form of statistical publication that are considered to be of importance and have met certain standards.