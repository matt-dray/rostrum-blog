---
title: 'Render blog stats with a GitHub Action'
author: Matt Dray
date: '2021-04-14'
slug: gha-readme
categories:
  - code
  - meta
tags:
  - github-actions
  - r
  - rmarkdown  
draft: yes
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="tldr" class="section level1">
<h1>tl;dr</h1>
<p>Display up-to-date stats in your blog’s GitHub repo with a scheduled GitHub Action.</p>
</div>
<div id="happy-birthday" class="section level1">
<h1>Happy birthday</h1>
<p>This blog has been knocking around for three years now. I wrote [a post on its first birthday(<a href="https://www.rostrum.blog/2019/04/14/one-year/" class="uri">https://www.rostrum.blog/2019/04/14/one-year/</a>) with a simple 2D plot of the posts to date.</p>
<p>Only now, two years later, have I thought to put this info into the blog’s README on GitHub— along with some other little stats, like total number of posts—and have it update on schedule with a GitHub Action.</p>
</div>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>A GitHub Action<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> is scheduled for the early hours of each day. <a href="https://github.com/matt-dray/rostrum-blog/blob/master/.github/workflows/render-rmarkdown.yaml">The YAML</a> for the Action reads like ‘at the specified time<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, set up a remote environment with R and some dependencies, then render the R Markdown file and push the changes to GitHub.’</p>
<p>Basically, the repo’s <a href="https://github.com/matt-dray/rostrum-blog/blob/master/README.Rmd">README.Rmd</a> (R Markdown format) is knitted to a counterpart <a href="https://github.com/matt-dray/rostrum-blog/blob/master/README.md">README.md</a> (GitHub-flavoured markdown), which is displayed when you visit the repo.</p>
<p>The real magic is in some R code chunks at the top of <a href="https://github.com/matt-dray/rostrum-blog/blob/master/README.md">the README.Rmd file</a> itself. There’s some R code there that uses {rvest} to scrape the archive page of the blog and create a dataframe of post titles and their publish dates.</p>
<p>That information can be cajoled to show some basic stats like the current number of posts, posts per month, days since last post, etc, which can be displayed with inline R code. I also added a dropdown with a table of all the posts to date and, of course, a plot showing the distribution of posts over time can be created too.</p>
<p>I added a line at the bottom with <code>lubridate::today()</code> so it’s obvious when the stats were last updated.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>I’ve written before about GitHub Actions to create <a href="https://www.rostrum.blog/2020/09/21/londonmapbot/">a Twitter bot</a> and for <a href="https://www.rostrum.blog/2020/08/09/ghactions-pkgs/">continuous integration of R packages</a>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>I wrote about cron strings in <a href="https://www.rostrum.blog/2021/04/10/dialga/">an earlier post</a>, which details <a href="https://github.com/matt-dray/dialga">the {dialga} package</a> for translating from R to cron to English.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
