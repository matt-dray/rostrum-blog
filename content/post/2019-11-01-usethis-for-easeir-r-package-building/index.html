---
title: 'Build an R package with {usethis}'
author: Matt Dray
date: '2019-11-01'
slug: usethis
categories:
  - code
  - tutorial
  - package
  - talk
tags:
  - cats
  - devtools
  - git
  - github
  - glue
  - pkgdown
  - r
  - roxygen2
  - testthat
  - usethis
  - xaringan
draft: no
---



<div class="figure">
<img src="/post/2019-11-01-usethis-for-easeir-r-package-building_files/ossie.jpeg" alt="A black cat lounging across a large wooden table." width=500 />
<p class="caption">
Ossie, a Cabinet Office cat (via <a href="https://twitter.com/cabinetofficeuk/status/807195882823319552/photo/1" target="_blank">@cabinetofficeuk</a>)
</p>
</div>
<div id="tldr" class="section level1">
<h1>tl;dr</h1>
<ul>
<li>I gave a talk about creating an R package with helper functions from <a href="https://usethis.r-lib.org/" target="_blank">the {usethis} package</a></li>
<li>In the session I created a new package from scratch called {cabinet} for identifying the cats that live in the UK Government’s <a href="https://www.gov.uk/government/organisations/cabinet-office">Cabinet Office</a></li>
<li><a href="https://matt-dray.github.io/r-pkg-slides/#1" target="_blank">See the slides in a dedicated window</a> or <a href="https://github.com/matt-dray/r-pkg-slides" target="_blank">view their source</a></li>
<li>See the <a href="https://github.com/matt-dray/cabinet" target="_blank">{cabinet} package source</a> and its <a href="https://matt-dray.github.io/cabinet/" target="_blank">website</a></li>
<li><a href="#resources">Jump to a list</a> of other materials</li>
</ul>
</div>
<div id="coffee-packaging" class="section level1">
<h1>Coffee packaging</h1>
<p>I gave a talk at a <a href="https://co-analysis.github.io/co-coffee-and-coding/" target="_blank">Cabinet Office Coffee &amp; Coding session</a> about building R packages from scratch. The emphasis was on <a href="https://usethis.r-lib.org/" target="_blank">the {usethis} package</a>, which contains lots of package-setup functions that make your life easier.</p>
<p>The focus is on beginners who may never have written a package before.</p>
<p>Click on the slides embedded below and cycle through with your arrow keys, or <a href="https://matt-dray.github.io/r-pkg-slides/#1" target="_blank">you can open them fullscreen in a dedicated browser tab</a>. Press the ‘P’ button your keyboard to see the presenter notes.</p>
<iframe src="https://matt-dray.github.io/r-pkg-slides/" width="700" height="525" frameborder="0" allowtransparency="true" allow="encrypted-media">
</iframe>
<p>I made the slides using <a href="https://slides.yihui.name/xaringan/" target="_blank">Yihui Xie’s {xaringan} implementation of remark.js</a> and I used my own {gdstheme} package for the theme (<a href="https://www.rostrum.blog/2019/05/24/xaringan-template/" target="_blank">read the blog</a> or <a href="https://github.com/matt-dray/gdstheme" target="_blank">see the source on GitHub</a>).</p>
</div>
<div id="talk-summary" class="section level1">
<h1>Talk summary</h1>
<p>Basically you can make a minimal R package with only:</p>
<ul>
<li><code>usethis::create_package()</code> to set up the minimal package structure</li>
<li><code>usethis::create_r()</code> to set up a script for your functions</li>
<li><code>devtools::document()</code> to generate minimal documentation from your files</li>
</ul>
<p>The {usethis} package also helps you set up internal and long-form documentation, testing, version control, a GitHub repository and more. {pkgdown} even generates a website from your documentation to make it more user-friendly.</p>
</div>
<div id="cat-egorise" class="section level1">
<h1>Cat-egorise</h1>
<p>In the session I live-built a package called {cabinet}. You can:</p>
<ul>
<li>look at the package’s <a href="https://github.com/matt-dray/cabinet/" target="_blank">source code on GitHub</a></li>
<li>see the package’s <a href="https://matt-dray.github.io/cabinet/" target="_blank">website</a>, made with {pkgdown}</li>
<li>install the package yourself with <code>remotes::install_github("matt-dray/cabinet")</code></li>
</ul>
<p>The package only has one (very important) function, <code>cabinet_cat()</code>, which checks whether a supplied character string matches the name of either of <a href="https://www.bbc.co.uk/news/uk-politics-38262832" target="_blank">the Cabinet Office’s cats</a>.</p>
<p>Like:</p>
<pre class="r"><code># remotes::install_github(&quot;matt-dray/cabinet)
library(cabinet)
cabinet_cat(&quot;Ossie&quot;)</code></pre>
<pre><code>## Ossie is a good Cabinet Office kitty.</code></pre>
<pre class="r"><code>cabinet_cat(&quot;Larry&quot;)</code></pre>
<pre><code>## Larry isn&#39;t a Cabinet Office cat!</code></pre>
<pre class="r"><code>cabinet_cat(&quot;Garfield&quot;)</code></pre>
<pre><code>## You&#39;ve much to learn about government cats.</code></pre>
</div>
<div id="resources" class="section level1">
<h1>Excellent resources</h1>
<p>There are some really good resources out there already. I like the following:</p>
<ul>
<li>Hilary Parker’s <a href="https://hilaryparker.com/2014/04/29/writing-an-r-package-from-scratch/" target="_blank">post</a> to write a package from scratch (beginner)</li>
<li>Tomas Westlake’s <a href="https://r-mageddon.netlify.com/post/writing-an-r-package-from-scratch/" target="_blank">update</a> to Hilary’s post (beginner)</li>
<li>Emil Hvitfeldt’s <a href="https://www.hvitfeldt.me/blog/usethis-workflow-for-package-development/" target="_blank">post</a>, focusing on {usethis} (beginner/intermediate)</li>
<li>Karl Broman’s <a href="https://kbroman.org/pkg_primer/" target="_blank">site</a>, a primer for package developement (intermediate)</li>
<li>Hadley Wickham’s <a href="http://r-pkgs.had.co.nz/" target="_blank">book</a> (intermediate/advanced)</li>
</ul>
<p>Tom’s post is probably the best place to start if you want to create a package with {usethis} from scratch as a beginner.</p>
<hr />
<details>
<p><summary>Session info</summary></p>
<pre><code>## [1] &quot;Last updated 2020-06-07&quot;</code></pre>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.0.0 (2020-04-24)
##  os       macOS Mojave 10.14.6        
##  system   x86_64, darwin17.0          
##  ui       X11                         
##  language (EN)                        
##  collate  en_GB.UTF-8                 
##  ctype    en_GB.UTF-8                 
##  tz       Europe/London               
##  date     2020-06-07                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────
##  package     * version    date       lib source                            
##  assertthat    0.2.1      2019-03-21 [1] CRAN (R 4.0.0)                    
##  blogdown      0.19       2020-05-22 [1] CRAN (R 4.0.0)                    
##  bookdown      0.19       2020-05-15 [1] CRAN (R 4.0.0)                    
##  cabinet     * 0.0.0.9000 2020-06-07 [1] Github (matt-dray/cabinet@441b227)
##  cli           2.0.2      2020-02-28 [1] CRAN (R 4.0.0)                    
##  crayon        1.3.4      2017-09-16 [1] CRAN (R 4.0.0)                    
##  digest        0.6.25     2020-02-23 [1] CRAN (R 4.0.0)                    
##  evaluate      0.14       2019-05-28 [1] CRAN (R 4.0.0)                    
##  fansi         0.4.1      2020-01-08 [1] CRAN (R 4.0.0)                    
##  glue          1.4.1      2020-05-13 [1] CRAN (R 4.0.0)                    
##  htmltools     0.4.0      2019-10-04 [1] CRAN (R 4.0.0)                    
##  knitr         1.28       2020-02-06 [1] CRAN (R 4.0.0)                    
##  magrittr      1.5        2014-11-22 [1] CRAN (R 4.0.0)                    
##  Rcpp          1.0.4.6    2020-04-09 [1] CRAN (R 4.0.0)                    
##  rlang         0.4.6      2020-05-02 [1] CRAN (R 4.0.0)                    
##  rmarkdown     2.1        2020-01-20 [1] CRAN (R 4.0.0)                    
##  sessioninfo   1.1.1      2018-11-05 [1] CRAN (R 4.0.0)                    
##  stringi       1.4.6      2020-02-17 [1] CRAN (R 4.0.0)                    
##  stringr       1.4.0      2019-02-10 [1] CRAN (R 4.0.0)                    
##  withr         2.2.0      2020-04-20 [1] CRAN (R 4.0.0)                    
##  xfun          0.14       2020-05-20 [1] CRAN (R 4.0.0)                    
##  yaml          2.2.1      2020-02-01 [1] CRAN (R 4.0.0)                    
## 
## [1] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</code></pre>
</details>
</div>
